@using System.Text
@using System.Globalization
@using System.Text.RegularExpressions
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@{
    // --- SLUG FONKSİYONU ---
    Func<string, string> GenerateSlug = (phrase) => 
    {
        if (string.IsNullOrEmpty(phrase)) return "";
        string str = phrase.ToLower(new CultureInfo("tr-TR"));
        str = str.Replace("ı", "i").Replace("ğ", "g").Replace("ü", "u").Replace("ş", "s").Replace("ö", "o").Replace("ç", "c");
        str = Regex.Replace(str, @"[^a-z0-9\s-]", "");
        str = Regex.Replace(str, @"\s+", "-").Trim();
        str = Regex.Replace(str, @"-+", "-");
        str = str.Trim('-'); 
        return str;
    };
}

<link rel="stylesheet" href="/css/project-cards.css">
<!-- Font Awesome için CDN linki (eğer halihazırda sitenizde yoksa) -->

<div class="projects-section" id="projectsSection">
    <div class="container">
        <div class="section-header">
            <h1 class="section-title">
                <span class="title-main">PROJELER</span>
            </h1>
        </div>

        <div class="projects-grid">
            @{
                var projects = new[]
                {
                    new { Name = "BALIKLIDERE", Link = "baliklidere", Image = "/media/sq3mnqcv/baliklidere-tarihce-cerkez-mimari.webp", Description = "Balıklıdere’de, tarihî dere yatağına nazır – sessiz doğada huzurlu bir yatırım fırsatı sizi bekliyor.", IsKonut = false, Location = "Balıkesir, Susurluk" },
                    new { Name = "ÇİNİKENT", Link = "cinikent", Image = "/media/kmgdwvz0/cinikent-3.jpg", Description = "Geleceğin kazancı ve şehrin konforu bir arada. Kütahya'nın gelişim aksında, sanayinin yanı başında stratejik bir yatırım ve modern bir yaşam.", IsKonut = true, Location = "Kütahya, Merkez" },
                    new { Name = "DİKİLİ", Link = "aqua-dikili", Image = "/media/0ikp2ink/dikili-izmir-villa-deniz-manzara.webp", Description = "Doğa ile uyum içinde, modern yaşamın konforunu sunan villa projesi. Deniz manzaralı parseller ile huzurun adresi.", IsKonut = false, Location = "İzmir, Dikili" },
                    new { Name = "YENİŞEHİR", Link = "port-yenisehir", Image = "/media/srbncqio/yenisehir-bursa-stratejik-yatirim.webp", Description = "Bursa'nın lojistik kalbinde, havalimanı ve YHT'ye komşu stratejik yatırım. Değeri her gün artan bir gelecek.", IsKonut = false, Location = "Bursa, Yenişehir" },
                    new { Name = "REŞADİYE", Link = "teras-resadiye", Image = "/media/vohjj0w2/resadiye-susurluk-koy-yasam.webp", Description = "Doğanın huzuru ve modern konforun mükemmel dengesi. Şehirlere yakın, olanakları tam ideal bir köy hayatı.", IsKonut = false, Location = "Balıkesir, Susurluk" },
                    new { Name = "BİGA", Link = "troya-biga", Image = "/media/zzxprvsk/biga-canakkale-deniz-yatirim.webp", Description = "Hem işinize ve limana hem de denize ve doğaya dakikalar içinde ulaşın. Huzur ve stratejinin mükemmel birleşimi.", IsKonut = false, Location = "Çanakkale, Biga" }
                };

                foreach (var project in projects)
                {
                    var projectSlug = GenerateSlug(project.Name);
                    <div class="project-card" data-location="@project.Name">
                        
                        @if (project.IsKonut)
                        {
                            <div class="konut-badge" style="height: 34px; width: 70px;">
                                <i class="fas fa-star"></i>
                                <span style="font-size: 0.50rem">KONUT</span>
                            </div>
                        }
                        else {
                            <div class="konut-badge arsa-beyaz">
                                <i class="fas fa-star" style="color:#045129"></i>
                                <span style="color: #045129">ARSA</span>
                            </div>
                        }
                        <div class="card-header">
                            <h3 class="card-title">@project.Name</h3>
                        </div>
                        
                        <!-- YENİ YAPI (DOĞRU): -->
                        <div class="card-image-container">
                            <img src="@project.Image" alt="@project.Name">
                            <div class="card-description-overlay">
                                <p>@project.Description</p>
                            </div>
                        </div>

                        <div class="card-footer">
                            <div class="location-info">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>@project.Location</span>
                            </div>
                            <div class="card-actions">
                                <a href="/@project.Link" class="btn btn-primary">PROJEYİ İNCELE</a>
                                <a href="#" class="call-me-detail btn btn-secondary">FORM DOLDURUN</a>
                            </div>
                        </div>

                    </div>
                }

                // *** DÜZELTİLMİŞ VE PERFORMANSLI KONTROL BLOĞU ***
                if (ViewData["IsProjectListPage"] as bool? == true)
                {
                    var newProjects = new[]
                    {
                        new { Name = "KUVAYİ MİLLİYE", Link = "park-kuvayi-milliye", Image = "/media/rqfpfzr2/kuvayi-milliye-balikersir-prestij-yatirimwebp.webp", Description = "Balıkesir'in yeni prestij bölgesi burada kuruluyor. Kolej ve hastane projelerinin kalbinde, lüks bir yaşam ve akıllı yatırım.", IsKonut = false, Location = "Balıkesir, Karesi" },
                        new { Name = "AYDIN", Link = "olivra-aydin", Image = "/media/2eeji2vu/aydin-germencik-ege-yasam-arsa.webp", Description = "Şehir konforu ve Ege'nin tatil ruhu bir arada. Germencik merkezde, Kuşadası'na yarım saat mesafede dört mevsim yaşam.", IsKonut = false, Location = "Aydın, Germencik" },
                        new { Name = "DELİCE", Link = "delice-zirve", Image = "/media/pkvmixmc/delice-dursunbey-uretim-koy-yatirimi.webp", Description = "Aradığınız her şeye sahip, kendi kendine yeten gelişmiş bir köy. Hem üretken bir yaşam hem de güvenli bir yatırım.", IsKonut = false, Location = "Balıkesir, Dursunbey" },
                        new { Name = "GÜNEYCE", Link = "aria-guneyce", Image = "/media/uxhne2pk/guneyce-ankara-termal-huzur.webp", Description = "Başkent'in stresine sağlıklı bir mola. Ankara'ya yakın, termal zenginlikleriyle ünlü, huzur dolu bir kaçış noktası.", IsKonut = false, Location = "Ankara, Güdül" },
                        new { Name = "KALAYCILAR", Link = "prestij-kalaycilar", Image = "/media/bj2liz5u/kalaycilar-balikersir-luks-yasam.webp", Description = "Geleceğin lüks yaşam merkezi bugünden şekilleniyor. Değeri kanıtlanmış, seçkin bir yatırım fırsatı.", IsKonut = false, Location = "Balıkesir, Karesi" },
                        new { Name = "ARMUTLU", Link = "vista-armutlu", Image = "/media/hpkdt3qv/armutlu-sindirgı-doga-huzur.webp", Description = "Fıstık çamı ormanları arasında, şehrin gürültüsünden uzakta gerçek bir huzur sığınağı. Sakinlik ve doğa arayanlar için.", IsKonut = false, Location = "Balıkesir, Sındırgı" },
                        new { Name = "SEYİTLER", Link = "montiva-seyitler", Image = "/media/5caopel2/seyitler-kutahya-stratejik-yatirim.webp", Description = "Hem işinize ve limana hem de denize ve doğaya dakikalar içinde ulaşın. Huzur ve stratejinin mükemmel birleşimi.", IsKonut = false, Location = "Kütahya, Merkez" },
                        new { Name = "İBİLLER", Link = "verda-ibiller", Image = "/media/dceh34j3/ibiller-sindirgı-termal-doga-yatirimi.webp", Description = "Sındırgı'nın şifalı termal sularına komşu, huzurlu bir doğa yatırımı. Sağlıklı bir geleceğin temellerini atın.", IsKonut = false, Location = "Balıkesir, Sındırgı" },
                        new { Name = "ILICABOĞAZI", Link = "panora-ilicabogazi", Image = "/media/0dojwmyn/ilicabogazi-susurluk-kaplica-yatirim.webp", Description = "Gelişen kaplıca bölgesinde, sağlık ve yatırım potansiyeli bir arada. Yeni otel projeleriyle değeri artan lokasyon.", IsKonut = false, Location = "Balıkesir, Susurluk" }
                    };

                    foreach (var project in newProjects)
                    {
                        var projectSlug = GenerateSlug(project.Name);

                        <div class="project-card" data-location="@project.Name">
                            
                            @if (project.IsKonut)
                            {
                                <div class="konut-badge">
                                    <i class="fas fa-star"></i>
                                    <span>KONUT</span>
                                </div>
                            }
                            else {
                                <div class="konut-badge arsa-beyaz">
                                    <i class="fas fa-star" style="color:#045129"></i>
                                    <span style="color: #045129">ARSA</span>
                                </div>
                            }
                            
                            <div class="card-header">
                                <h3 class="card-title">@project.Name</h3>
                            </div>
                            
                            <!-- YENİ YAPI (DOĞRU): -->
                            <div class="card-image-container">
                                <img src="@project.Image" alt="@project.Name">
                                <div class="card-description-overlay">
                                    <p>@project.Description</p>
                                </div>
                            </div>
                            
                            <div class="card-footer">
                                <div class="location-info">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>@project.Location</span>
                                </div>
                                <div class="card-actions">
                                    <a href="/@project.Link" class="btn btn-primary">PROJEYİ İNCELE</a>
                                    <a href="#" class="call-me-detail btn btn-secondary">FORM DOLDURUN</a>
                                </div>
                            </div>

                        </div>
                    }
                }
            }
        </div>

        @* --- YENİ EKLENEN BÖLÜM --- *@
        @if (ViewData["IsProjectListPage"] as bool? != true)
        {
            <div class="view-all-btn-container" style="text-align: center; margin-top: 50px;">
                <a href="/projeler/" class="view-all-btn">Tüm Projeleri Göster</a>
            </div>
        }
    </div>
</div>

<script src="/Scripts/project-cards.js"></script>

<style>
@@media(min-width: 769px){
    .location-info{
        left:28px;
    }
}

</style>