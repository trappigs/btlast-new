@using System.Text
@using System.Globalization
@using System.Text.RegularExpressions
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@{
    // --- SLUG FONKSİYONU ---
    Func<string, string> GenerateSlug = (phrase) => 
    {
        if (string.IsNullOrEmpty(phrase)) return "";
        string str = phrase.ToLower(new CultureInfo("tr-TR"));
        str = str.Replace("ı", "i").Replace("ğ", "g").Replace("ü", "u").Replace("ş", "s").Replace("ö", "o").Replace("ç", "c");
        str = Regex.Replace(str, @"[^a-z0-9\s-]", "");
        str = Regex.Replace(str, @"\s+", "-").Trim();
        str = Regex.Replace(str, @"-+", "-");
        str = str.Trim('-'); 
        return str;
    };
}

<link rel="stylesheet" href="/css/project-cards.css">
<!-- Font Awesome için CDN linki (eğer halihazırda sitenizde yoksa) -->

    <div class="projects-section" id="projectsSection">
        <div class="container">
            <div class="section-header">
                <h1 class="section-title title-main">
                    PROJELER
                </h1>
            </div>

            <div class="projects-grid">
                @{
                    var projects = new[]
                    {
                        new { Name = "OKÇUGÖL", Link = "okcugol", Image = "/media/qxxbm1hq/susurluk-tarima-dayali-ihtisas-osb-yakin-arsa.webp", Description = "Sinpaş Kasaba Thermal Wellness Resort’un karşısında, imarlı ve müstakil tapulu arsalarla kazançlı bir yatırım fırsatı.", IsKonut = false, Location = "Balıkesir, Susurluk", IsNew = true },
                        new { Name = "YENİŞEHİR", Link = "yenisehir", Image = "/media/srbncqio/yenisehir-bursa-stratejik-yatirim.webp", Description = "Bursa'nın lojistik kalbinde, havalimanı ve YHT'ye komşu stratejik yatırım. Değeri her gün artan bir gelecek.", IsKonut = false, Location = "Bursa, Yenişehir", IsNew = false },
                        new { Name = "DİKİLİ", Link = "dikili", Image = "/media/0ikp2ink/dikili-izmir-villa-deniz-manzara.webp", Description = "Doğa ile uyum içinde, modern yaşamın konforunu sunan villa projesi. Deniz manzaralı parseller ile huzurun adresi.", IsKonut = false, Location = "İzmir, Dikili", IsNew = false },
                        new { Name = "BALIKLIDERE", Link = "baliklidere", Image = "/media/uaweyjxt/balıklıdere-projesi-imarli-arsa-yatirimi-kapak-fotografi.webp", Description = "Balıklıdere'de, sessiz doğada huzurlu bir yatırım fırsatı sizi bekliyor.", IsKonut = false, Location = "Balıkesir, Susurluk", IsNew = true },
                        new { Name = "BİGA", Link = "biga", Image = "/media/zzxprvsk/biga-canakkale-deniz-yatirim.webp", Description = "Hem işinize ve limana hem de denize ve doğaya dakikalar içinde ulaşın. Huzur ve stratejinin mükemmel birleşimi.", IsKonut = false, Location = "Çanakkale, Biga", IsNew = false },
                        new { Name = "ILICABOĞAZI", Link = "ilicabogazi", Image = "/media/0dojwmyn/ilicabogazi-susurluk-kaplica-yatirim.webp", Description = "Gelişen kaplıca bölgesinde, sağlık ve yatırım potansiyeli bir arada. Yeni otel projeleriyle değeri artan lokasyon.", IsKonut = false, Location = "Balıkesir, Susurluk", IsNew = false }
                    };

                    foreach (var project in projects)
                    {
                        var projectSlug = GenerateSlug(project.Name);
                        <div class="project-card" data-location="@project.Name">

                            @* YENİ BADGE - Kağıt köşesi stili *@
                            @if (project.IsNew)
                            {
                                <div class="paper-corner-badge green"></div>
                            }

                            @if (project.IsKonut)
                            {
                                <div class="konut-badge" style="height: 34px; width: 70px;">
                                    <i class="fas fa-star"></i>
                                    <span style="font-size: 0.50rem">KONUT</span>
                                </div>
                            }
                            else {
                                <div class="konut-badge arsa-beyaz">
                                    <i class="fas fa-star" style="color:#045129"></i>
                                    <span style="color: #045129">ARSA</span>
                                </div>
                            }

                            <div class="card-header">
                                <h3 class="card-title">@project.Name</h3>
                            </div>

                            <a href="/@project.Link" title="@project.Name + İmarlı Arsa" class="card-image-container card-image-link">
                                <img src="@project.Image" alt="@project.Name">
                                <div class="card-description-overlay">
                                    <p>@project.Description</p>
                                </div>
                            </a>

                            <div class="card-footer">
                                <div class="location-info">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>@project.Location</span>
                                </div>
                                <div class="card-actions">
                                    <a href="/@project.Link" title="@project.Name + İmarlı Arsa" class="btn btn-primary">PROJEYİ İNCELE</a>
                                    <a href="#" class="call-me-detail btn btn-secondary">FORM DOLDURUN</a>
                                </div>
                            </div>

                        </div>
                    }
                

                // *** DÜZELTİLMİŞ VE PERFORMANSLI KONTROL BLOĞU ***
                if (ViewData["IsProjectListPage"] as bool? == true)
                {
                    var newProjects = new[]
                    {
                        new { Name = "KUVAYİ MİLLİYE", Link = "kuvayi-milliye", Image = "/media/ozxbm3aa/kuvayi-milliye-proje-kapak-gorseli-imarlı-satilik-arsalar-balikesir-karesi.webp", Description = "Balıkesir'in yeni prestij bölgesi burada kuruluyor. Kolej ve hastane projelerinin kalbinde, lüks bir yaşam ve akıllı yatırım.", IsKonut = false, Location = "Balıkesir, Karesi", IsNew = false},
                        new { Name = "KEPEKLER", Link = "kepekler", Image = "/media/lhemsqj5/kepsut_gunbatimi_arsa.webp", Description = "Balıkesir Kepsut Kepekler’de imarlı arsa fırsatı! Doğaya yakın, altyapısı hazır, yüksek değer artışı potansiyeline sahip yatırım parselleri sizi bekliyor.", IsKonut = false, Location = "Balıkesir, Susurluk", IsNew = true},
                        new { Name = "REŞADİYE", Link = "resadiye", Image = "/media/vohjj0w2/resadiye-susurluk-koy-yasam.webp", Description = "Doğanın huzuru ve modern konforun mükemmel dengesi. Şehirlere yakın, olanakları tam ideal bir köy hayatı.", IsKonut = false, Location = "Balıkesir, Susurluk", IsNew = false },
                        new { Name = "SEYİTLER", Link = "seyitler", Image = "/media/5caopel2/seyitler-kutahya-stratejik-yatirim.webp", Description = "Hem işinize ve limana hem de denize ve doğaya dakikalar içinde ulaşın. Huzur ve stratejinin mükemmel birleşimi.", IsKonut = false, Location = "Kütahya, Merkez", IsNew = false },
                        new { Name = "AYDIN", Link = "aydin", Image = "/media/2eeji2vu/aydin-germencik-ege-yasam-arsa.webp", Description = "Şehir konforu ve Ege'nin tatil ruhu bir arada. Germencik merkezde, Kuşadası'na yarım saat mesafede dört mevsim yaşam.", IsKonut = false, Location = "Aydın, Germencik", IsNew = false },
                        new { Name = "DELİCE", Link = "delice", Image = "/media/pkvmixmc/delice-dursunbey-uretim-koy-yatirimi.webp", Description = "Aradığınız her şeye sahip, kendi kendine yeten gelişmiş bir köy. Hem üretken bir yaşam hem de güvenli bir yatırım.", IsKonut = false, Location = "Balıkesir, Dursunbey", IsNew = false },
                        new { Name = "GÜNEYCE", Link = "guneyce", Image = "/media/uxhne2pk/guneyce-ankara-termal-huzur.webp", Description = "Başkent'in stresine sağlıklı bir mola. Ankara'ya yakın, termal zenginlikleriyle ünlü, huzur dolu bir kaçış noktası.", IsKonut = false, Location = "Ankara, Güdül", IsNew = false },
                        new { Name = "KALAYCILAR", Link = "kalaycilar", Image = "/media/bj2liz5u/kalaycilar-balikersir-luks-yasam.webp", Description = "Geleceğin lüks yaşam merkezi bugünden şekilleniyor. Değeri kanıtlanmış, seçkin bir yatırım fırsatı.", IsKonut = false, Location = "Balıkesir, Karesi", IsNew = false },
                        new { Name = "ARMUTLU", Link = "armutlu", Image = "/media/hpkdt3qv/armutlu-sindirgı-doga-huzur.webp", Description = "Fıstık çamı ormanları arasında, şehrin gürültüsünden uzakta gerçek bir huzur sığınağı. Sakinlik ve doğa arayanlar için.", IsKonut = false, Location = "Balıkesir, Sındırgı", IsNew = false },
                        new { Name = "İBİLLER", Link = "ibiller", Image = "/media/dceh34j3/ibiller-sindirgı-termal-doga-yatirimi.webp", Description = "Sındırgı'nın şifalı termal sularına komşu, huzurlu bir doğa yatırımı. Sağlıklı bir geleceğin temellerini atın.", IsKonut = false, Location = "Balıkesir, Sındırgı", IsNew = false }
                    };

                    foreach (var project in newProjects)
                    {
                        var projectSlug = GenerateSlug(project.Name);

                        <div class="project-card" data-location="@project.Name">
                            
                            @if (project.IsNew)
                            {
                                <div class="paper-corner-badge green"></div>
                            }

                            @if (project.IsKonut)
                            {
                                <div class="konut-badge">
                                    <i class="fas fa-star"></i>
                                    <span>KONUT</span>
                                </div>
                            }
                            else {
                                <div class="konut-badge arsa-beyaz">
                                    <i class="fas fa-star" style="color:#045129"></i>
                                    <span style="color: #045129">ARSA</span>
                                </div>
                            }
                            
                            <div class="card-header">
                                <h3 class="card-title">@project.Name</h3>
                            </div>
                            
                            <!-- YENİ YAPI (DOĞRU): -->
                            <a href="/@project.Link" title="@project.Name İmarlı Arsa" class="card-image-container card-image-link">
                                <img src="@project.Image" alt="@project.Name">
                                <div class="card-description-overlay">
                                    <p>@project.Description</p>
                                </div>
                            </a>
                            
                            <div class="card-footer">
                                <div class="location-info">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>@project.Location</span>
                                </div>
                                <div class="card-actions">
                                    <a href="/@project.Link" title="@project.Name + İmarlı Arsa" class="btn btn-primary">PROJEYİ İNCELE</a>
                                    <a href="#" class="call-me-detail btn btn-secondary">FORM DOLDURUN</a>
                                </div>
                            </div>
                        </div>
                    }
                }
            }
        </div>

        @* --- YENİ EKLENEN BÖLÜM --- *@
        @if (ViewData["IsProjectListPage"] as bool? != true)
        {
            <div class="view-all-btn-container" style="text-align: center; margin-top: 50px;">
                <a href="/projeler/" class="view-all-btn">Tüm Projeleri Göster</a>
            </div>
        }
    </div>
</div>

<script src="/Scripts/project-cards.js"></script>

<style>
@@media(min-width: 769px){
    .location-info{
        left:28px;
    }
}

</style>